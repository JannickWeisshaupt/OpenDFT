
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Flight graph example &#8212; mayavi 4.6.1 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Mlab visual example" href="example_mlab_visual.html" />
    <link rel="prev" title="Protein example" href="example_protein.html" />
<style type="text/css">
  body {
    /* Very bottom copyright, etc. info */
    background: #4d598d;
  }

  .documentwrapper {
    /* Blank area on left bar */
    background: #24326e;
  }

  .related {
    /* Long horizontal nav bars */
    background: #3c4b8a!important;
  }

  .sphinxsidebarwrapper {
    /* Filled part of left sidebar */
    background: #24326e;
  }

  a {
    color: #253370;
  }

  .sphinxsidebarwrapper a {
    color: #f2f2f2!important;
  }
</style>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="example_mlab_visual.html" title="Mlab visual example"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="example_protein.html" title="Protein example"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">mayavi 4.6.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="examples.html" accesskey="U">Example gallery</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="flight-graph-example">
<span id="example-flight-graph"></span><h1>Flight graph example<a class="headerlink" href="#flight-graph-example" title="Permalink to this headline">¶</a></h1>
<p>An example showing a graph display between cities positionned on the
Earth surface.</p>
<p>This graph displays the longest fligh routes operated by Boing
777. The two main interests of this example are that it shows how to
build a graph of arbitrary connectivity, and that it shows how to
position data on the surface of the Earth.</p>
<p>The graph is created by first building a scalar scatter dataset with the
mlab.points3d command, and adding line information to it. One of the
difficulties is that the lines are specified using the indexing number of
the points, so we must ‘massage’ our data when loading it. A similar
technique to plot the graph is done in the <a class="reference internal" href="example_protein.html#example-protein"><span class="std std-ref">Protein example</span></a>.
Another example of graph plotting, showing a different technique to plot
the graph, can be seen on <a class="reference internal" href="example_delaunay_graph.html#example-delaunay-graph"><span class="std std-ref">Delaunay graph example</span></a>.</p>
<p>To simplify things we do not plot the connection on the surface of the
Earth, but as straight lines going throught the Earth. As a result
must use transparency to show the connection.</p>
<p>Data source: <a class="reference external" href="http://www.777fleetpage.com/777fleetpage3.htm">http://www.777fleetpage.com/777fleetpage3.htm</a></p>
<img alt="../_images/example_flight_graph.jpg" class="align-center" src="../_images/example_flight_graph.jpg" />
<p><strong>Python source code:</strong> <a class="reference download internal" href="../_downloads/flight_graph.py" download=""><code class="xref download docutils literal notranslate"><span class="pre">flight_graph.py</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="s2">###############################################################################</span>
<span class="s2"># The data. This could be loaded from a file, or scraped from a website</span>

<span class="s2">routes_data = &quot;&quot;&quot;</span>
<span class="n">Bombay</span><span class="p">,</span><span class="n">Atlanta</span>
<span class="n">Johannesburg</span><span class="p">,</span><span class="n">Atlanta</span>
<span class="n">Dubai</span><span class="p">,</span><span class="n">Los</span> <span class="n">Angeles</span>
<span class="n">Dubai</span><span class="p">,</span><span class="n">Houston</span>
<span class="n">Dubai</span><span class="p">,</span><span class="n">San</span> <span class="n">Francisco</span>
<span class="n">New</span> <span class="n">York</span><span class="p">,</span><span class="n">Hong</span> <span class="n">Kong</span>
<span class="n">Newark</span><span class="p">,</span><span class="n">Hong</span> <span class="n">Kong</span>
<span class="n">Doha</span><span class="p">,</span><span class="n">Houston</span>
<span class="n">Toronto</span><span class="p">,</span><span class="n">Hong</span> <span class="n">Kong</span>
<span class="n">Bombay</span><span class="p">,</span><span class="n">Newark</span>
<span class="n">Bombay</span><span class="p">,</span><span class="n">New</span> <span class="n">York</span>
<span class="n">Vancouver</span><span class="p">,</span><span class="n">Hong</span> <span class="n">Kong</span>
<span class="n">Dubai</span><span class="p">,</span><span class="n">Sao</span> <span class="n">Paulo</span>
<span class="n">Los</span> <span class="n">Angeles</span><span class="p">,</span><span class="n">Sydney</span>
<span class="n">Chicago</span><span class="p">,</span><span class="n">Delhi</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">cities_data = &quot;&quot;&quot;</span>
<span class="n">Toronto</span><span class="p">,</span><span class="o">-</span><span class="mf">79.38</span><span class="p">,</span><span class="mf">43.65</span>
<span class="n">Chicago</span><span class="p">,</span><span class="o">-</span><span class="mf">87.68</span><span class="p">,</span><span class="mf">41.84</span>
<span class="n">Houston</span><span class="p">,</span><span class="o">-</span><span class="mf">95.39</span><span class="p">,</span><span class="mf">29.77</span>
<span class="n">New</span> <span class="n">York</span><span class="p">,</span><span class="o">-</span><span class="mf">73.94</span><span class="p">,</span><span class="mf">40.67</span>
<span class="n">Vancouver</span><span class="p">,</span><span class="o">-</span><span class="mf">123.13</span><span class="p">,</span><span class="mf">49.28</span>
<span class="n">Los</span> <span class="n">Angeles</span><span class="p">,</span><span class="o">-</span><span class="mf">118.41</span><span class="p">,</span><span class="mf">34.11</span>
<span class="n">San</span> <span class="n">Francisco</span><span class="p">,</span><span class="o">-</span><span class="mf">122.45</span><span class="p">,</span><span class="mf">37.77</span>
<span class="n">Atlanta</span><span class="p">,</span><span class="o">-</span><span class="mf">84.42</span><span class="p">,</span><span class="mf">33.76</span>
<span class="n">Dubai</span><span class="p">,</span><span class="mf">55.33</span><span class="p">,</span><span class="mf">25.27</span>
<span class="n">Sydney</span><span class="p">,</span><span class="mf">151.21</span><span class="p">,</span><span class="o">-</span><span class="mf">33.87</span>
<span class="n">Hong</span> <span class="n">Kong</span><span class="p">,</span><span class="mf">114.19</span><span class="p">,</span><span class="mf">22.38</span>
<span class="n">Bombay</span><span class="p">,</span><span class="mf">72.82</span><span class="p">,</span><span class="mf">18.96</span>
<span class="n">Delhi</span><span class="p">,</span><span class="mf">77.21</span><span class="p">,</span><span class="mf">28.67</span>
<span class="n">Newark</span><span class="p">,</span><span class="o">-</span><span class="mf">82.43</span><span class="p">,</span><span class="mf">40.04</span>
<span class="n">Johannesburg</span><span class="p">,</span><span class="mf">28.04</span><span class="p">,</span><span class="o">-</span><span class="mf">26.19</span>
<span class="n">Doha</span><span class="p">,</span><span class="mf">51.53</span><span class="p">,</span><span class="mf">25.29</span>
<span class="n">Sao</span> <span class="n">Paulo</span><span class="p">,</span><span class="o">-</span><span class="mf">46.63</span><span class="p">,</span><span class="o">-</span><span class="mf">23.53</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="s2">###############################################################################</span>
<span class="s2"># Load the data, and put it in data structures we can use</span>
<span class="s2">import csv</span>
<span class="s2">routes_table = [i for i in csv.reader(routes_data.split(&#39;</span><span class="se">\n</span><span class="s2">&#39;)[1:-1])]</span>

<span class="s2"># Build a dictionnary returning GPS coordinates for each city</span>
<span class="s2">cities_coord = dict()</span>
<span class="s2">for line in list(csv.reader(cities_data.split(&#39;</span><span class="se">\n</span><span class="s2">&#39;)))[1:-1]:</span>
<span class="s2">    name, long_, lat = line</span>
<span class="s2">    cities_coord[name] = (float(long_), float(lat))</span>

<span class="s2"># Store all the coordinates of connected cities in a list also keep</span>
<span class="s2"># track of which city corresponds to a given index in the list. The</span>
<span class="s2"># connectivity information is specified as connecting the i-th point</span>
<span class="s2"># with the j-th.</span>
<span class="s2">cities = dict()</span>
<span class="s2">coords = list()</span>
<span class="s2">connections = list()</span>
<span class="s2">for city1, city2 in routes_table[1:-1]:</span>
<span class="s2">    if not city1 in cities:</span>
<span class="s2">        cities[city1] = len(coords)</span>
<span class="s2">        coords.append(cities_coord[city1])</span>
<span class="s2">    if not city2 in cities:</span>
<span class="s2">        cities[city2] = len(coords)</span>
<span class="s2">        coords.append(cities_coord[city2])</span>
<span class="s2">    connections.append((cities[city1], cities[city2]))</span>


<span class="s2">###############################################################################</span>
<span class="s2">from mayavi import mlab</span>
<span class="s2">mlab.figure(1, bgcolor=(0.48, 0.48, 0.48), fgcolor=(0, 0, 0),</span>
<span class="s2">               size=(400, 400))</span>
<span class="s2">mlab.clf()</span>

<span class="s2">###############################################################################</span>
<span class="s2"># Display points at city positions</span>
<span class="s2">import numpy as np</span>
<span class="s2">coords = np.array(coords)</span>
<span class="s2"># First we have to convert latitude/longitude information to 3D</span>
<span class="s2"># positioning.</span>
<span class="s2">lat, long = coords.T * np.pi / 180</span>
<span class="s2">x = np.cos(long) * np.cos(lat)</span>
<span class="s2">y = np.cos(long) * np.sin(lat)</span>
<span class="s2">z = np.sin(long)</span>

<span class="s2">points = mlab.points3d(x, y, z,</span>
<span class="s2">                     scale_mode=&#39;none&#39;,</span>
<span class="s2">                     scale_factor=0.03,</span>
<span class="s2">                     color=(0, 0, 1))</span>

<span class="s2">###############################################################################</span>
<span class="s2"># Display connections between cities</span>
<span class="s2">connections = np.array(connections)</span>
<span class="s2"># We add lines between the points that we have previously created by</span>
<span class="s2"># directly modifying the VTK dataset.</span>
<span class="s2">points.mlab_source.dataset.lines = connections</span>
<span class="s2">points.mlab_source.reset()</span>
<span class="s2"># To represent the lines, we use the surface module. Using a wireframe</span>
<span class="s2"># representation allows to control the line-width.</span>
<span class="s2">mlab.pipeline.surface(points, color=(1, 1, 1),</span>
<span class="s2">                              representation=&#39;wireframe&#39;,</span>
<span class="s2">                              line_width=4,</span>
<span class="s2">                              name=&#39;Connections&#39;)</span>

<span class="s2">###############################################################################</span>
<span class="s2"># Display city names</span>
<span class="s2">for city, index in cities.items():</span>
<span class="s2">    label = mlab.text(x[index], y[index], city, z=z[index],</span>
<span class="s2">                      width=0.016 * len(city), name=city)</span>
<span class="s2">    label.property.shadow = True</span>

<span class="s2">###############################################################################</span>
<span class="s2"># Display continents outline, using the VTK Builtin surface &#39;Earth&#39;</span>
<span class="s2">from mayavi.sources.builtin_surface import BuiltinSurface</span>
<span class="s2">continents_src = BuiltinSurface(source=&#39;earth&#39;, name=&#39;Continents&#39;)</span>
<span class="s2"># The on_ratio of the Earth source controls the level of detail of the</span>
<span class="s2"># continents outline.</span>
<span class="s2">continents_src.data_source.on_ratio = 2</span>
<span class="s2">continents = mlab.pipeline.surface(continents_src, color=(0, 0, 0))</span>

<span class="s2">###############################################################################</span>
<span class="s2"># Display a semi-transparent sphere, for the surface of the Earth</span>

<span class="s2"># We use a sphere Glyph, throught the points3d mlab function, rather than</span>
<span class="s2"># building the mesh ourselves, because it gives a better transparent</span>
<span class="s2"># rendering.</span>
<span class="s2">sphere = mlab.points3d(0, 0, 0, scale_mode=&#39;none&#39;,</span>
<span class="s2">                                scale_factor=2,</span>
<span class="s2">                                color=(0.67, 0.77, 0.93),</span>
<span class="s2">                                resolution=50,</span>
<span class="s2">                                opacity=0.7,</span>
<span class="s2">                                name=&#39;Earth&#39;)</span>

<span class="s2"># These parameters, as well as the color, where tweaked through the GUI,</span>
<span class="s2"># with the record mode to produce lines of code usable in a script.</span>
<span class="s2">sphere.actor.property.specular = 0.45</span>
<span class="s2">sphere.actor.property.specular_power = 5</span>
<span class="s2"># Backface culling is necessary for more a beautiful transparent</span>
<span class="s2"># rendering.</span>
<span class="s2">sphere.actor.property.backface_culling = True</span>

<span class="s2">###############################################################################</span>
<span class="s2"># Plot the equator and the tropiques</span>
<span class="s2">theta = np.linspace(0, 2 * np.pi, 100)</span>
<span class="s2">for angle in (- np.pi / 6, 0, np.pi / 6):</span>
<span class="s2">    x = np.cos(theta) * np.cos(angle)</span>
<span class="s2">    y = np.sin(theta) * np.cos(angle)</span>
<span class="s2">    z = np.ones_like(theta) * np.sin(angle)</span>

<span class="s2">    mlab.plot3d(x, y, z, color=(1, 1, 1),</span>
<span class="s2">                        opacity=0.2, tube_radius=None)</span>

<span class="s2">mlab.view(63.4, 73.8, 4, [-0.05, 0, 0])</span>
<span class="s2">mlab.show()</span>
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/mayavi-logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="example_protein.html"
                        title="previous chapter">Protein example</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="example_mlab_visual.html"
                        title="next chapter">Mlab visual example</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/auto/example_flight_graph.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="example_mlab_visual.html" title="Mlab visual example"
             >next</a> |</li>
        <li class="right" >
          <a href="example_protein.html" title="Protein example"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">mayavi 4.6.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="examples.html" >Example gallery</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2008-2018, Enthought Inc..
      Last updated on Aug 08, 2018.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.1.
    </div>
  </body>
</html>